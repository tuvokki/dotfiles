#!/usr/bin/python
import subprocess, argparse

parser = argparse.ArgumentParser(description='Pretty print the output of disk information.')
parser.add_argument('-o', '--output')
parser.add_argument('-v', dest='verbose', action='store_true')
args = parser.parse_args()
# ... do something with args.output ...
# ... do something with args.verbose ..

proc = subprocess.Popen(['mount'],stdout=subprocess.PIPE)
for line in proc.stdout:
  if line.split()[4] == 'ext3':
    mountpoint = line.split()[2]
    mproc = subprocess.Popen(['df', '-h',mountpoint],stdout=subprocess.PIPE)
    for mline in mproc.stdout:
      if mline.split()[5] == mountpoint:
        if args.verbose:
          print "%s\nFree: %8s\nUsed: %8s (%s of %s)\n" % (mountpoint,  mline.split()[3],  mline.split()[4],  mline.split()[2],  mline.split()[1])
        else:
          print "%10s free: %8s" % (mountpoint,  mline.split()[3])
